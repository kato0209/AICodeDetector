間の類似度を計算する関数 def calculate ションを生成する関数 def recommend collections import defaultdict ピアソン相関係数を計算 return pearsonr scipy.stats import pearsonr User User unique data タセットの作成 data 既に評価したアイテムを除外 rated とする if len Rating ションスコアを計算 recommendations ションを生成 recommendations の評価を抽出 common Item recommendations <extra_id_0> サンプルデ ー タセットの作成 レコメンデ ー ションを生成する関数 アイテムのレコメンデ ー ションスコアを計算 def calculate def recommend <extra_id_1> ピアソン相関係数を計算 return に対するレコメンデ ー ションを生成 import defaultdict 間の類似度を計算する関数 def ションを生成する関数 def import numpy import pandas scipy.stats import collections import return pearsonr import pearsonr items similarity Item recommendations common <extra_id_2> <extra_id_3> import score in recommendations.items <extra_id_4> similarity in similarities.items <extra_id_5> calculate recommend similarities rated score recommendations.items recommended True <extra_id_6> def row in data user in data pd.DataFrame merge 共通のアイテムがない場合は、類似度を int iterrows set sorted key reverse score for item サンプルデ ピアソン相関係数に基づくユ 共通のアイテムに対する両ユ とする len ピアソン相関係数を計算 レコメンデ 他の全ユ unique アイテムのレコメンデ similarities.items 既に評価したアイテムを除外 スコアに基づいてアイテムをソ lambda numpy pandas scipy.stats collections タセットの作成 間の類似度を計算する関数 の評価を抽出 ションを生成する関数 との類似度を計算 ションスコアを計算 に対するレコメンデ ションを生成