docs relevant query rocchio <extra_id_0> <extra_id_1> original <extra_id_2> query vector param Weight <extra_id_3> vector original query vector <extra_id_4> Apply the Rocchio documents document vectors Rocchio formula List Convert lists alpha beta Implement the Rocchio gamma non-relevant return non-relevant documents vectors document import numpy param original import def numpy lists relevant document vectors np.mean axis docs.size param alpha param beta param relevant query refinement non-relevant document vectors param gamma Convert Calculate Apply relevant document modified query vector query vector based modified query Implement refinement List of non-relevant usage original vector based algorithm for query lists to numpy relevant return List of relevant modified arrays vectorized operations formula usage based operations relevant vector for relevant numpy arrays relevant and non-relevant arrays for vectorized vectorized operations vectorized operations relevant