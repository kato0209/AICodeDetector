ションを生成する関数 def item コサイン類似度に基づくアイテム間の類似度を計算する関数 def calculate item Rating fillna similarity return item コサイン類似度を計算 item アイテム間の類似度を計算 item ションを生成 item def item 類似したアイテムとその類似度を取得 similar return recommended <extra_id_0> アイテムベ ー スのレコメンデ 未評価のアイテムに対してスコアを計算 scores user User loc スのレコメンデ ー ションを生成する関数 に対するアイテムベ ー スのレコメンデ スのレコメンデ ー ションを生成 def calculate とアイテムのマトリックスを作成 user の評価を取得 user コサイン類似度に基づくアイテム間の類似度を計算する関数 def ションを生成する関数 def based <extra_id_1> Rating index items data columns matrix.columns recommend recommendations cosine <extra_id_2> return <extra_id_3> scores recommended True def <extra_id_4> <extra_id_5> similarity in similar matrix data.pivot table matrix.T pd.DataFrame data.set defaultdict float ratings.iteritems dropna items.iteritems ratings.get sorted scores.items key reverse import コサイン類似度に基づくアイテム間の類似度を計算する関数 fillna コサイン類似度を計算 アイテムベ 対象ユ loc 未評価のアイテムに対してスコアを計算 類似したアイテムとその類似度を取得 pd.isna スコアに基づいてアイテムをソ lambda アイテム間の類似度を計算 とアイテムのマトリックスを作成 ションを生成する関数 の評価を取得 に対するアイテムベ ションを生成