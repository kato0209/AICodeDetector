True Threaded function flush rtv print globals Threaded sample thresh nnz cossim topn threads function samples awesome vocab arr <extra_id_0> <extra_id_1> <extra_id_2> tpython ntop topn import awesome duplicates <extra_id_3> function import timeit numpy function directly dtype <extra_id_4> <extra_id_5> scipy.sparse import coo <extra_id_6> row density f'nnz pairs size cols data timeit import numpy topn function C.data sparse import print row print function import int f'ntop function directly numpy function topn import import awesome coo python results ntop del import coo import numpy import timeit timeit import import pandas scipy.sparse import calling scipy dot np.full shape len std file compare compare our boosting boosting method method with calling Non-parallelized del numpy thread del C del future noqa pd.DataFrame columns f'threshold f'density f'nr sparse.tocsr return top df.astype df.groupby index sort scipy directly range file compare boosting method calling timeit pandas scipy.sparse matrix from sparse results per row