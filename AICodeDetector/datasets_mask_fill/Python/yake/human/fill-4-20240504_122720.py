import StringsFileUtil import *

""" Create xls sheet import pyExcelerator import Add command option StringsFileUtil import pyExcelerator strings files optparse import OptionParser import directory path destDir option keys Add command storage forms including single import StringsFileUtil import strings index value multiple file storage forms key dirname stringsDir filePath option multiple file storage forms import dirnames convert method import StringsFileUtil string xls stringfile source path stringfile targetDir print parser type parser.add print storage forms including single import OptionParser import time multiple xls files keyName countryCode lproj path targetDir optparse import import pyExcelerator pyExcelerator import Start convert stringfile os.walk xls file def file lprojDirs Target file directory filenames print storage forms forms including command option def Add Create def single xls file filenames in os.walk files directory. fileName excelStorageForm file def convertToSingleFile multiple file storage files def convertToMultipleFiles excel keyIndex default countryCode dirname in lprojDirs xls def startConvert filenames if fi.endswith dirnames if di.endswith default is multiple. stringfile in stringsFiles options StringsFileUtil sheet OptionParser Target file multiple files xls files xls sheet multiple xls time.strftime os.makedirs workbook pyExcelerator.Workbook workbook.add dirname.replace StringsFileUtil.getKeysAndValues len workbook.save Start single option di.endswith range successfully file def files def directory return xls def including single command option file directory option def addParser OptionParser from StringsFileUtil string Start converting single file single xls dirname in dirnames def addParser def convertToSingleFile coding parser type parser.parse args stringfile.replace def convertToMultipleFiles options.targetDir print addParser