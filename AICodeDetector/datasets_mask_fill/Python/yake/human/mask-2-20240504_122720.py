True Sampling threaded function thresh cossim awesome profile def awesome threads <extra_id_0> Sampling threaded print return awesome topn def awesome <extra_id_1> Sampling <extra_id_2> profile def <extra_id_3> <extra_id_4> vocab nnz end return def profile <extra_id_5> samples <extra_id_6> <extra_id_7> thread matrix topn import awesome density row size cols data sparse Sampling non-parallelized import awesome run Sampling non-parallelized sparse mprof memory int coo topn function f'nnz mem prof.py False profiler function import dot pairs shape topn import import print f'ntop import profile profiler import profile prof.py mprof C.data mprof run function import timeit profiler import runs import coo mprof executable executable package script prof.py mprof plot profiled runs future noqa f'threshold f'density f'nr sparse.tocsr a.astype b.astype plot range level timeit numpy pandas scipy.sparse profiling bring subsequent profiled mprof plot non-parallelized import timeit timeit import import numpy import pandas scipy.sparse import len non-parallelized sparse import timeit import scipy.sparse import coo matrix from sparse profiling to bring subsequent profiled run without profiling bring the memory subsequent profiled runs timeit import numpy