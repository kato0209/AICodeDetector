True Threaded function rtv globals Threaded print cossim thresh vocab csr <extra_id_0> timeit.timeit number <extra_id_1> topn <extra_id_2> flush awesome threads row samples duplicates <extra_id_3> <extra_id_4> <extra_id_5> topn import awesome <extra_id_6> <extra_id_7> density size cols top numpy function import numpy function def sparse result topn function original function numpy numpy function directly function import timeit Original sparse coo matrix return row.data arg results topn import Original scipy.sparse import coo function def import awesome function import numpy original def scipy row print import timeit import timeit import numpy import print function directly calling scipy dot int f'nnz shape def import coo elif nnz results per row thread import numpy zip row.indices import timeit timeit import scipy.sparse import A.dot row index top matches return sorted file compare compare our boosting boosting method method with calling future noqa f'density f'nr sparse.tocsr directly file compare boosting method calling timeit scipy.sparse score row.getnnz np.argpartition key lower bound scipy and numpy list index matches sorted lambda matrix from sparse elif element greater element is greater return None elif row which element