threading import Condition Main thread exiting threading import current random class BlockingQueue threading import Thread time import random import random class thread import time import time import return item def item def enqueue threading import True import Condition Main thread Thread class BlockingQueue thread exiting import current random class blocking def consumer def producer import time time import import random Condition from threading import Thread thread import def dequeue def enqueue size self.curr self.curr target args daemon return item consumed item ncurrent size size item print time.sleep item def import threading import True to True import queue Condition consumer producer main queue q import self.max format format max size self_curr self_curr id myQueue import threading import True from True import queue Queue BlockingQueue val Thread from threading init queue q exit q import True from threading import threading import self.q q.dequeue getName random.randint q.enqueue dequeue return enqueue ncurrent queue consumed exiting size of queue time random class