similarity <extra_id_0> store the original original dataset <extra_id_1> copy sim distances index movies neighbors len <extra_id_2> nominator predicted number def movie df.iloc neighbors knn df.copy store create the copy brute knn.fit original dataset create recommendation df.values indices tolist copy.pop sum recommender NearestNeighbors metric cosine algorithm knn.kneighbors enumerate df.index movies.index movies.remove distances.pop similarity.copy m,user def knn brute knn.fit list range recommend