data = np.load(download(directory, FILE_TEMPLATE.format(split=split_name))) # The last <extra_id_0> is <extra_id_1> in both <extra_id_2> and test. data = data[:-1] # Each row is a list of word ids in the document. We first <extra_id_3> this to # sparse COO matrix (which automatically sums the repeating words). Then, # we <extra_id_4> this COO matrix to CSR format which allows for fast querying of # documents. num_documents = data.shape[0] indices = np.array([(row_idx, column_idx) for row_idx, row in enumerate(data) for