with ops.name_scope(name, "kl_chi_chi", values=[a.logits, b.logits]): # The two logits can be re-parameterized, so we need to keep # them to put them in the same order as they are added to all. a_logits = a.logits + b.logits b_logits = b.logits + a.logits a_probs = a.probs + b.probs b_probs = b.probs + a.probs # The two total probs is the sum of the batchwise KL(a || b) batch_total_probs =