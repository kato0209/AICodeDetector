with ops.name_scope(name, "kl_half_normal_half_normal", [a.logits, b.logits]): # Calculate the <extra_id_0> for the two distributions. logits = math_ops.matmul(a.logits, b.logits, transpose_a=True) # Broadcast logits to the <extra_id_1> shape. if isinstance(logits, ops.Tensor) and logits.get_shape().ndims is not None: logits = array_ops.expand_dims(logits, -1) <extra_id_2> math_ops.reduce_sum(logits, -1, name