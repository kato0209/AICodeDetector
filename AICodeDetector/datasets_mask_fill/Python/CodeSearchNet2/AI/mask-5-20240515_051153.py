if isinstance(tensor, list): tensor = np.array(tensor) if tensor.ndim!= 3: <extra_id_0> ValueError('Tensor must be 3D') if tensor.shape[0]!= nrow * ncol: raise ValueError('Tensor must have <extra_id_1> (nrow, ncol)') if tensor.shape[1]!= nrow * ncol: raise ValueError('Tensor must have <extra_id_2> (nrow, ncol)') if normalize: tensor = tensor / np.max(tensor) if normalize: tensor = tensor / np.max(np.abs(tensor