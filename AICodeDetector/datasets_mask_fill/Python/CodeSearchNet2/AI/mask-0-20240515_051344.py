with ops.name_scope(name, "kl_chi_chi", values=[a.logits, b.logits]): # The two <extra_id_0> can be re-parameterized, so we need to <extra_id_1> # them to put them in the same order as they are added to all. a_logits = a.logits + b.logits b_logits = b.logits + a.logits a_probs = a.probs + <extra_id_2> b_probs = b.probs + a.probs # <extra_id_3> the batchwise KL(a || b) batch_total_probs =