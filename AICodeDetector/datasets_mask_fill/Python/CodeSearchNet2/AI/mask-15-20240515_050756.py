if self.credentials is None: raise AirflowException("The environment variable GOOGLE_APPLICATION_CREDENTIALS must be set") # If the <extra_id_0> didn't <extra_id_1> the environment variable, <extra_id_2> a default one. if "GOOGLE_APPLICATION_CREDENTIALS" not in os.environ: os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = _get_default_gcp_credentials() self.credentials = _Credentials(self.credentials) # If the environment variable is missing, generate a default one. if "GOOGLE_APPLICATION_CREDENTIALS" not in os.environ: