numerically stable linear self. log normalization TODO stable numerically algorithm return log normalization def <extra_id_0> scope constant return def math method replaced self.df ops.log ops.exp