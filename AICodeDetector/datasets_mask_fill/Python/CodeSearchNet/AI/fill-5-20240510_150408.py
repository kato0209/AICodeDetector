session def run State.SUCCESS session.merge State.RUNNING session.merge elif self.state session def def run self.end date datetime.now self.state State.RUNNING State.SUCCESS session.merge State.SUCCESS session.merge else if not self.state State.RUNNING provide elif session run def