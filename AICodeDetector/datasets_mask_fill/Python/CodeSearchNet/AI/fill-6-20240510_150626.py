states state exchanged sampled replica math inputs sample weights zip results  array ops.where ops.logical ops.equal enumerate