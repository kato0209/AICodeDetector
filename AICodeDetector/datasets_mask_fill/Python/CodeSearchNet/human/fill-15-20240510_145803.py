ref Recall we made shape axis made axis non-negative output shape for shape axis ref.shape def expand non-batch case expansion False Recall made axis axis non-negative x.shape tf.shape input left ends case def expand non-batch made non-negative