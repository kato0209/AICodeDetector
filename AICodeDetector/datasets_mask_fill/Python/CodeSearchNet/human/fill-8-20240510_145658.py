shape util.rank tensorshape sample ndims x.shape self.event batch event tf.size input self.batch tf.rank tensor self. unexpanded _rank static ndims if isinstance isinstance