batch static shape input size implicit <extra_id_0> original tf.reduce prod tensor <extra_id_1> tensorshape Assumes ndims util.constant util.is fully defined return scope calculate reshape tf.equal tf.maximum tf.shape expanded tf.where tf.name tf.fill validations pylint disable assert util.assert rank message vector validate