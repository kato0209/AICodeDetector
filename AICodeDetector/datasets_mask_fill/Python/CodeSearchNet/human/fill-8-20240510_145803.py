test samples train test train samples train shape str train training training batches iterator Build batches heldout set samples entire heldout set .subtract shape True set return const empty .shuffle batch Build an iterator dataset tensor slices train.astype test.astype train.flatten test.flatten pixel np.mean axis test.shape entire heldout FLAGS.subtract shape True set return the entire iterator over training dataset.shuffle reshuffle iteration repeat shot set with batch return constant entire