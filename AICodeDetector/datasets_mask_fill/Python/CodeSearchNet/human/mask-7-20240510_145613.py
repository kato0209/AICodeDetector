slope level slightly tricky tricky to properly properly incorporate incorporate the batch <extra_id_0> autoregressive shape batch shape matrix <extra_id_1> fixed entries write slightly tricky properly incorporate batch fixed entries matrix shape correct matrix shape return shape written explicitly correct matrix tf.constant return written explicitly part mask to broadcast breaking add mask broadcast correct coef has shape breaking the matrix