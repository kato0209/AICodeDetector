optimizer def train loop lambda step def train lambda train loop run return tf.tuple return minimize optimizer def loss train step True build minimize return optimizer optimizer.minimize eagerly tensors while control inputs cond num vars tf.constant structure tf.executing tf.tuple lambda return a single single op. return def single steps