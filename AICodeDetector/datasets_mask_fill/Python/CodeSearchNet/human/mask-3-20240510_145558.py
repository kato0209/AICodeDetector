tensor batch ndims event size shape Reshape perm <extra_id_0> paddings <extra_id_1> eval hot dist.event tf.size input dist.batch eye Compute left-transpose one dim cyclically left-transpose return tf.transpose tf.reshape tf.eye dtype dist.dtype tf.ones constant dim tf.range dist cyclically left-transpose return tf.transpose