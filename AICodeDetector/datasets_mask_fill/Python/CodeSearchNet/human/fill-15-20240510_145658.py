dataset idx num Prefetching makes training vocabulary Build an iterator data dir training batches words Make iterator input dir predi training batches words Make iterator train vocab Load predi preloaded vocabulary def build Prefetch dir make preprocessor data dir Prefetching return download vocab.pkl pickle.load len idx.items training newsgroups shuffle repeat dataset.batch batch size shot True makes training open batches def train Prefetching return train def word idx in words False def eval iterator over training faster heldout set prefetch makes test set heldout eval words for word