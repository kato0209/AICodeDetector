num timesteps tensor indices input <extra_id_0> batch unmasked compute initial <extra_id_1> <extra_id_2> unmasked entry negindices tf.shape time masked time series axis gather rank dynamic rank time series initial index entry raise NotImplementedError requires static rank Extract the initial masked time Extract static rank tf.cast broadcast mask tf.range tf.reduce max raise NotImplementedError dynamic requires static return tf.squeeze masked params tf.newaxis requires return tf.squeeze static