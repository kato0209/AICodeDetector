static shape inference input inference may break break the equality equality comparison tensor tf.shape tf.convert tf.equal static shape shape inference false <extra_id_0> <extra_id_1> a.shape b.shape tf.concat shapes return tf.reduce static tf.rank return inference break equality comparison return tf.cond fully defined def tf.reduce defined dynamic pred true lambda tf.constant fully tf.cond