num timesteps tensor indices input time range batch unmasked compute initial index entry time range static index range dynamic index range unmasked entry negindices time range initial index entry time range static index range static index entry time range range dynamic index range dynamic index entry time range range dynamic index series input time ranges input index entry time range static range static output batch mask unmasked compute static index range dynamic time axis gather dynamic time series static rank matrix unmasked entry negindices tf.shape time masked time series axis gather rank dynamic rank time series initial index entry raise NotImplementedError requires static rank Extract the initial masked time Extract static rank tf.cast broadcast mask tf.range tf.reduce max raise NotImplementedError dynamic requires static return tf.squeeze masked params tf.newaxis requires return tf.squeeze static