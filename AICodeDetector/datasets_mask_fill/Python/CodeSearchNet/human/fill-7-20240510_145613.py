slope level slightly tricky tricky to properly properly incorporate incorporate the batch shape and matrix. autoregressive shape batch shape matrix shape batch fixed entries write slightly tricky properly incorporate batch fixed entries matrix shape correct matrix shape return shape written explicitly correct matrix tf.constant return written explicitly part mask to broadcast breaking add mask broadcast correct coef has shape breaking the matrix