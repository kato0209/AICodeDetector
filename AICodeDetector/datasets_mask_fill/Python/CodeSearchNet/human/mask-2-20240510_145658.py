lambda row batch input dataset def train def eval return train random sample size row tensor slices map shot iterator <extra_id_0> lambda IMAGE SHAPE def train eval astype repeat