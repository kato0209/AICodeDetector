delta failed or converged update Hessian gradient position factor inv ersatile position estimate inverse Hessian state.objective estimate inverse Compute failed state.position bfgs gradient position normalization term Compute the normalization state.position normalization return bfgs state.converged state.failed term singular tf.reduce sum input tensor axis tf.equal def state.inverse utils.update fields state tf.where return update the inverse