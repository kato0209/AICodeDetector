Log exponentiated term small term small exponentiated term stop gradient <extra_id_0> final result putting stop gradient Max <extra_id_1> centered put stop gradient result small stop final exponentiated term exp putting stop put stop eliminate unnecessary computation unnecessary computation canceled putting change eliminate unnecessary computation tf.stop sample put eliminate unnecessary